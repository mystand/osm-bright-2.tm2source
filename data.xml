<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE Map[]>
<Map srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">

<Parameters>
  <Parameter name="center">136.3403,49.1961,6</Parameter>
  <Parameter name="description"><![CDATA[OSM Bright 2]]></Parameter>
  <Parameter name="format">pbf</Parameter>
  <Parameter name="json"><![CDATA[{"vector_layers":[{"id":"landuse","description":"","fields":{"class":"String","area":"Number"}},{"id":"water","description":"","fields":{}},{"id":"waterway","description":"","fields":{"class":"String"}}]}]]></Parameter>
  <Parameter name="maxzoom">8</Parameter>
  <Parameter name="minzoom">0</Parameter>
  <Parameter name="name"><![CDATA[OSM Bright 2]]></Parameter>
</Parameters>


<Layer name="landuse"
  buffer-size="8"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[osm]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508.34,-20037508.34,20037508.34,20037508.34]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[geometry]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[( SELECT * FROM (
    -- landuse_gen0
    SELECT geometry, type as class, area
    FROM osm_landusages_gen0
    WHERE geometry && !bbox!
      AND z(!scale_denominator!) BETWEEN 4 AND 9

    -- landuse_gen1
    UNION ALL
    SELECT geometry, type as class, area
    FROM osm_landusages_gen1
    WHERE geometry && !bbox!
      AND z(!scale_denominator!) BETWEEN 10 AND 12

    -- landuse
    UNION ALL
    SELECT geometry, type as class, area
    FROM osm_landusages
    WHERE geometry && !bbox!
      AND z(!scale_denominator!) >= 12
  ) AS QUERY
 ORDER BY area DESC
) AS data]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="water"
  buffer-size="8"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[osm]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508.34,-20037508.34,20037508.34,20037508.34]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[geometry]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[( SELECT * FROM (
    -- water_polygons
    SELECT geom as geometry
    FROM water
    WHERE geom && !bbox!

    -- water_gen0
    UNION ALL
    SELECT geometry
    FROM osm_waterareas
    WHERE geometry && !bbox!
      AND area > 10000
      AND z(!scale_denominator!) BETWEEN 3 AND 9

    -- water_gen1
    UNION ALL
    SELECT geometry
    FROM osm_waterareas
    WHERE geometry && !bbox!
      AND area > 1000
      AND z(!scale_denominator!) BETWEEN 9 AND 12
  
    -- water
    UNION ALL
    SELECT geometry
    FROM osm_waterareas
    WHERE geometry && !bbox!
      AND z(!scale_denominator!) > 12
  ) AS QUERY
) AS data]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

<Layer name="waterway"
  buffer-size="8"
  srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0.0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs +over">
    
    <Datasource>
       <Parameter name="dbname"><![CDATA[osm]]></Parameter>
       <Parameter name="extent"><![CDATA[-20037508.34,-20037508.34,20037508.34,20037508.34]]></Parameter>
       <Parameter name="geometry_field"><![CDATA[geometry]]></Parameter>
       <Parameter name="geometry_table"><![CDATA[]]></Parameter>
       <Parameter name="host"><![CDATA[]]></Parameter>
       <Parameter name="key_field"><![CDATA[]]></Parameter>
       <Parameter name="max_size"><![CDATA[512]]></Parameter>
       <Parameter name="password"><![CDATA[]]></Parameter>
       <Parameter name="port"><![CDATA[]]></Parameter>
       <Parameter name="table"><![CDATA[( SELECT * FROM (
    -- waterway_low
    SELECT geometry, type as class
    FROM osm_waterways
    WHERE geometry && !bbox!
      AND type IN ('river', 'canal')
      AND z(!scale_denominator!) BETWEEN 8 AND 12

    -- waterway_med
    UNION ALL
    SELECT geometry, type as class
    FROM osm_waterways
    WHERE geometry && !bbox!
      AND type IN ('river', 'canal', 'stream')
      AND z(!scale_denominator!) BETWEEN 13 AND 14

    -- waterway_high
    UNION ALL
    SELECT geometry, type as class
    FROM osm_waterways
    WHERE geometry && !bbox!
      AND type IN ('river', 'canal', 'stream', 'ditch', 'drain')
      AND z(!scale_denominator!) >= 15
  ) AS QUERY
) AS data]]></Parameter>
       <Parameter name="type"><![CDATA[postgis]]></Parameter>
       <Parameter name="user"><![CDATA[]]></Parameter>
    </Datasource>
  </Layer>

</Map>